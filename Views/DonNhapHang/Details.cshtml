@model KhoHang_XNK.Models.DonNhapHang

@{
    ViewData["Title"] = "Chi Tiết Đơn Nhập Hàng";
    decimal tongTien = 0;
}

<h2 class="mb-4">Chi Tiết Đơn Nhập Hàng</h2>

<div class="card shadow-sm p-3 mb-4">
    <div class="card-body">
        <p><strong>Nhà Cung Cấp:</strong> @Model.NhaCungCap.TenNCC</p>
        <p><strong>Nhân Viên:</strong> @Model.NhanVien.HoTen</p>
        <p><strong>Kho:</strong> @Model.KhoHang.TenKho</p>
        <p><strong>Ngày Nhập:</strong> @Model.NgayNhap.ToString("dd/MM/yyyy")</p>
    </div>
</div>

<table class="table table-striped table-bordered">
    <thead class="thead-dark">
        <tr>
            <th>Tên Hàng Hóa</th>
            <th class="text-center">Số Lượng</th>
            <th class="text-right">Đơn Giá</th>
            <th class="text-right">Thành Tiền</th>
        </tr>
    </thead>
    <tbody>
        @if (ViewBag.ChiTietList != null && ViewBag.ChiTietList.Count > 0)
        {
            foreach (var item in ViewBag.ChiTietList)
            {
                decimal thanhTien = item.SoLuong * item.DonGia;
                tongTien += thanhTien;
                <tr>
                    <td>@item.HangHoa.TenHangHoa</td>
                    <td class="text-center">@item.SoLuong</td>
                    <td class="text-right">@item.DonGia.ToString("N0") đ</td>
                    <td class="text-right">@thanhTien.ToString("N0") đ</td>
                </tr>
            }   
        }
        else
        {
            <tr><td colspan="4" class="text-center">Không có dữ liệu</td></tr>
        }
    </tbody>
    @if (ViewBag.ChiTietList != null && ViewBag.ChiTietList.Count > 0)
    {
        <tfoot>
            <tr>
                <th colspan="3" class="text-right">Tổng Tiền:</th>
                <th class="text-right text-danger">@tongTien.ToString("N0") đ</th>
            </tr>
        </tfoot>
    }
</table>
@if (User.IsInRole("Admin"))
{
    if (Model.trangthaithanhtoan == 0)
    {
        <form method="post" asp-action="ConfirmPayment" asp-route-id="@Model.MaDonNhap">
            <button type="submit" class="btn btn-success">
                Xác nhận thanh toán
            </button>
        </form>
    }
}
<div class="mt-3">
    <a asp-action="Edit" asp-route-id="@Model.MaDonNhap" class="btn btn-primary">
        <i class="fas fa-edit"></i> Chỉnh sửa
    </a>
    <a asp-action="Index" class="btn btn-secondary">
        <i class="fas fa-arrow-left"></i> Quay lại
    </a>
</div>
